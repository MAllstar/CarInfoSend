<div style="float: left; margin-left: 600px; margin-top: 100px;">
    <div>
        <label>经纬度</label>
        <input id='loAndLa' type="text"></input>
        <label>组别</label>
        <input id="group" type="text"></input>
        <button id="add">添加</button>
    </div>
    <div>
        <table id="rsuTable" border="1px" cellpadding="0" cellspacing="0">
            <tr id='tableHead'>
                <th>编号</th>
                <th>经纬度</th>
                <th>范围内车辆数</th>
                <th>状态</th>
                <th>组别</th>
                <th><button id="refresh">刷新</button></th>
            <tr><td></td><td></td><td></td><td></td><td></td><td><button id="del0">删除</button></td>
            <tr><td></td><td></td><td></td><td></td><td></td><td><button>删除</button></td>
            <tr><td></td><td></td><td></td><td></td><td></td><td><button>删除</button></td>
            <tr><td></td><td></td><td></td><td></td><td></td><td><button>删除</button></td>
            <tr><td></td><td></td><td></td><td></td><td></td><td><button>删除</button></td>
            <tr><td></td><td></td><td></td><td></td><td></td><td><button>删除</button></td>
            <tr><td></td><td></td><td></td><td></td><td></td><td><button>删除</button></td>
            <tr><td></td><td></td><td></td><td></td><td></td><td><button>删除</button></td>
        </table>   
    </div>

    <div class = 'pages'>
        <a href="/rsu?pageNumber={{pageNumberDel}}"><</a>
        <a href="/rsu?pageNumber={{pageNumberDel}}">{{pageNumberDel}}</a>
        <a href="/rsu?pageNumber={{pageNumber}}">{{pageNumber}}</a>
        <a href="/rsu?pageNumber={{pageNumberAdd}}">{{pageNumberAdd}}</a>
        <a href="/rsu?pageNumber={{pageNumberAdd}}">></a>
    </div>
</div> 
<script>
    
    //到后端获取数据显示在表格
    var pageNumber = 0;
    pageNumber = getQueryStringArgs()["pageNumber"] || 0;
    $.get('/rsu/getData', function(data){
        for(var i = 0; i < 8 ; i++){
            var a=[];a[0] = data[i + 8 * pageNumber]._id;a[1] = data[i + 8 * pageNumber].loAndLa;
            a[2] = data[i + 8 * pageNumber].carNum;a[3] = data[i + 8 * pageNumber].state;a[4] = data[i + 8 * pageNumber].group;
            for(var j = 0; j < 5 ; j++){
                var tr =$('#rsuTable').find('tr');
                $(tr[i+1]).find('td').eq(j).text(a[j]);
            }
        }
    });
    ///???做删除按钮，获取当前删除按钮的_id
    console.log($("#del0").parent().parent().find("td").eq(1).text())
    //刷新按钮到后端获取数据显示在表格
    $('#refresh').click(function(){
        $.get('/rsu/getData', function(data){
            for(var i = 0; i < 8 ; i++){
                var a=[];a[0] = data[i + 8 * pageNumber]._id;a[1] = data[i + 8 * pageNumber].loAndLa;
                a[2] = data[i + 8 * pageNumber].carNum;a[3] = data[i + 8 * pageNumber].state;a[4] = data[i + 8 * pageNumber].group;
                for(var j = 0; j < 5 ; j++){
                    var tr =$('#rsuTable').find('tr');
                    $(tr[i+1]).find('td').eq(j).text(a[j]);
                }
            }
        });
    })

    //添加按钮传数据到后端写入数据库
    $('#add').click(function(){
        $.get('/rsu/rsuDatabase', 
            { 
                loAndLa: $('#loAndLa').val(),
                group: $('#group').val()
            }
        );
        $('#loAndLa').val('');
        $('#group').val('');
    })
    //显示目录
    $('#directory').css("display",'block');

    //前端获取url参数
    function getQueryStringArgs(){ 
        //取得查询字符串并去掉开头的问号
        var qs = (location.search.length > 0 ? location.search.substring(1) : ""), 
        //保存数据的对象
        args = {}, 
        //取得每一项
        items = qs.length ? qs.split("&") : [], 
        item = null, 
        name = null, 
        value = null, 
        //在 for 循环中使用
        i = 0, 
        len = items.length; 
        //逐个将每一项添加到 args 对象中
        for (i=0; i < len; i++){ 
            item = items[i].split("="); 
            name = decodeURIComponent(item[0]); 
            value = decodeURIComponent(item[1]); 
            if (name.length) { 
                args[name] = value; 
            } 
        } 
        return args; 
    }
</script>